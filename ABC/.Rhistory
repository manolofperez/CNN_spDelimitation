IBDInd<-c(0.678)
IBDPop<-c(0.536)
wilcox.test(IBDInd,IBDPop, alternative="h",exact=F)
wilcox.test(IBDInd,IBDPop, alternative="g",exact=F)
wilcox.test(IBDInd,IBDPop, alternative="l",exact=F)
wilcox.test(IBDInd,IBDPop,exact=F)
wilcox.test(IBDInd,IBDPop, alternative="g",exact=F)
IBDmammrept<-c(0.686, 0.667)
IBDarthplant<-c(0.553,0.507)
wilcox.test(IBDmammrept,IBDarthplant, alternative="g",exact=F)
IBDmammrept<-c(0.686)
, 0.667)
IBDarthplant<-c(0.507)
0.553,
wilcox.test(IBDmammrept,IBDarthplant, alternative="g",exact=F)
IBDterrfresh<-c(0.68, 0.667)
IBDmariflyt<-c(0.563,0.52)
wilcox.test(IBDterrfresh,IBDmariflyt, alternative="g",exact=F)
IBDpoikilo<-c(0.611)
IBDhomeo<-c(0.647)
wilcox.test(IBDhomeo,IBDpoikilo, alternative="g",exact=F)
IBDmammreptamph<-c(0.686, 0.667,0.63)
IBDarthplantbird<-c(0.553,0.507,0.562)
wilcox.test(IBDmammreptamph,IBDarthplantbird, alternative="g",exact=F)
IBDInd<-c(0.678)
IBDPop<-c(0.536)
wilcox.test(IBDInd,IBDPop, alternative="g",exact=F)
IBDmammreptamph<-c(0.686, 0.667,0.63)
IBDarthplantbird<-c(0.553,0.507,0.562)
wilcox.test(IBDmammreptamph,IBDarthplantbird, alternative="g",exact=F)
IBDterrfresh<-c(0.68, 0.667)
IBDmariflyt<-c(0.563,0.52)
wilcox.test(IBDterrfresh,IBDmariflyt, alternative="g",exact=F)
IBDpoikilo<-c(0.611)
IBDhomeo<-c(0.647)
wilcox.test(IBDhomeo,IBDpoikilo, alternative="g",exact=F)
library(coala)
install.packages("coala")
library(coala)
model <- coal_model(c(2, 3, 4), 2) +
feat_mutation(5) +
feat_migration(1, symmetric = TRUE) +
sumstat_jsfs("jsfs_12", populations = c(1, 2)) +
sumstat_jsfs("jsfs_123", populations = c(1, 2, 3))
stats <- simulate(model)
print(stats$jsfs_12)
print(stats$jsfs_123)
sumstat= c(sum(stats$jsfs_12)[1, ]), sum(stats$jsfs_12)[, 1]), sum(stats$jsfs_12)[-1, -1]))
sumstat= c(sum(jsfs_12)[1, ]), sum(jsfs_12)[, 1]), sum(jsfs_12)[-1, -1]))
sumstat= c(sum(jsfs_12[1, ]), sum(jsfs_12[, 1]), sum(jsfs_12[-1, -1]))
sumstat= c(sum(stats$jsfs_12[1, ]), sum(stats$jsfs_12[, 1]), sum(stats$jsfs_12[-1, -1]))
sumstat
model <- coal_model(c(10, 10), 1) +
feat_mutation(par_prior("theta", rnorm(1, 5, .5))) +
feat_migration(par_prior("m", rnorm(1, .5, .1)), symmetri = TRUE) +
sumstat_jsfs(transformation = function(jsfs) {
c(sum(jsfs[1, ]), sum(jsfs[, 1]), sum(jsfs[-1, -1]))
})
sim_results <- simulate(model, nsim = 2)
abc_sumstat <- create_abc_sumstat(sim_results, model)
print(abc_sumstat)
View(abc_sumstat)
stats$jsfs_12[1, ]
stats$jsfs_12
jsfs
stats$jsfs
stats$jsfs_12[, 1]
stats$jsfs_12[-1, 11]
stats$jsfs_12[-1, -1]
sumstat = c(sum(stats$jsfs_12[1, ]), sum(stats$jsfs_12[, 1]), sum(stats$jsfs_12[-1, -1]))
sumstat
library(abc)
setwd("/Volumes/HD2/manolo/OneDrive/LaGEVol/Artigos_DoutoradoBelManolo/ArtigoDelimitacao/ABC/ABC_ES/IndMarkers/ABC")
sust<-read.table("SuSt.txt")
numsim=200000
numloc=20
sust <- data.frame(s1=tapply(sust[,1], factor(rep(1:numsim, each=numloc)), mean,na.rm=T),
s2=tapply(sust[,2], factor(rep(1:numsim, each=numloc)), mean,na.rm=T),
s3=tapply(sust[,3], factor(rep(1:numsim, each=numloc)), mean,na.rm=T),
s4=tapply(sust[,4], factor(rep(1:numsim, each=numloc)), mean,na.rm=T),
s5=tapply(sust[,5], factor(rep(1:numsim, each=numloc)), mean,na.rm=T),
s6=tapply(sust[,6], factor(rep(1:numsim, each=numloc)), mean,na.rm=T),
s7=tapply(sust[,7], factor(rep(1:numsim, each=numloc)), mean,na.rm=T),
s8=tapply(sust[,8], factor(rep(1:numsim, each=numloc)), mean,na.rm=T),
s9=tapply(sust[,9], factor(rep(1:numsim, each=numloc)), mean,na.rm=T),
s10=tapply(sust[,10], factor(rep(1:numsim, each=numloc)), mean,na.rm=T),
s11=tapply(sust[,11], factor(rep(1:numsim, each=numloc)), mean,na.rm=T),
s12=tapply(sust[,12], factor(rep(1:numsim, each=numloc)), mean,na.rm=T),
s13=tapply(sust[,13], factor(rep(1:numsim, each=numloc)), mean,na.rm=T),
s14=tapply(sust[,14], factor(rep(1:numsim, each=numloc)), mean,na.rm=T),
s15=tapply(sust[,15], factor(rep(1:numsim, each=numloc)), mean,na.rm=T))
pcasust <- prcomp(sust, scale = TRUE)
pcaemp<-predict(pcasust, emp, scale=TRUE)
models<-scan("models.txt")
emp<-read.table("Emp.txt")
numsim=1
numloc=15
emp <- data.frame(s1=tapply(emp[,1], factor(rep(1:numsim, each=numloc)), mean,na.rm=T),
s2=tapply(emp[,2], factor(rep(1:numsim, each=numloc)), mean,na.rm=T),
s3=tapply(emp[,3], factor(rep(1:numsim, each=numloc)), mean,na.rm=T),
s4=tapply(emp[,4], factor(rep(1:numsim, each=numloc)), mean,na.rm=T),
s5=tapply(emp[,5], factor(rep(1:numsim, each=numloc)), mean,na.rm=T),
s6=tapply(emp[,6], factor(rep(1:numsim, each=numloc)), mean,na.rm=T),
s7=tapply(emp[,7], factor(rep(1:numsim, each=numloc)), mean,na.rm=T),
s8=tapply(emp[,8], factor(rep(1:numsim, each=numloc)), mean,na.rm=T),
s9=tapply(emp[,9], factor(rep(1:numsim, each=numloc)), mean,na.rm=T),
s10=tapply(emp[,10], factor(rep(1:numsim, each=numloc)), mean,na.rm=T),
s11=tapply(emp[,11], factor(rep(1:numsim, each=numloc)), mean,na.rm=T),
s12=tapply(emp[,12], factor(rep(1:numsim, each=numloc)), mean,na.rm=T),
s13=tapply(emp[,13], factor(rep(1:numsim, each=numloc)), mean,na.rm=T),
s14=tapply(emp[,14], factor(rep(1:numsim, each=numloc)), mean,na.rm=T),
s15=tapply(emp[,15], factor(rep(1:numsim, each=numloc)), mean,na.rm=T))
pcasust <- prcomp(sust, scale = TRUE)
pcaemp<-predict(pcasust, emp, scale=TRUE)
summary(pcasust)
pcasust<-pcasust$x[,1:3]
pcaemp<-pcaemp[1:3]
emp
pcaemp
pcasust
NN05<-postpr(emp, models, sust, tol = 0.005, method = "neuralnet")
summary(NN05)
PCANN05<-postpr(pcaemp, models, pcasust, tol = 0.005, method = "neuralnet")
summary(PCANN05)
library(abc)
setwd("/Volumes/HD2/manolo/OneDrive/LaGEVol/Artigos_DoutoradoBelManolo/ArtigoDelimitacao/ABC/ABC_CO/IndMarkers/ABC")
sust<-read.table("SuSt.txt")
models<-scan("models.txt")
pcasust <- prcomp(sust, scale = TRUE)
summary(pcasust)
pcasust<-pcasust$x[,1:4]
cv.modsel <- cv4postpr(models, sust, nval=10, tol=.001, method="neuralnet")
pca.cv.modsel <- cv4postpr(models, pcasust, nval=10, tol=.001, method="neuralnet")
summary(cv.modsel)
summary(pca.cv.modsel)
cv.modsel <- cv4postpr(models, sust, nval=10, tol=.005, method="neuralnet")
pca.cv.modsel <- cv4postpr(models, pcasust, nval=10, tol=.005, method="neuralnet")
summary(cv.modsel)
summary(pca.cv.modsel)
pcasust<-pcasust$x[,1:4]
pcasust
cv.modsel <- cv4postpr(models, sust, nval=10, tol=.01, method="neuralnet")
pca.cv.modsel <- cv4postpr(models, pcasust, nval=10, tol=.01, method="neuralnet")
summary(cv.modsel)
summary(pca.cv.modsel)
cv.modsel <- cv4postpr(models, sust, nval=100, tol=.005, method="neuralnet")
summary(cv.modsel)
cv.modsel <- cv4postpr(models, sust, nval=50, tol=.005, method="neuralnet")
summary(cv.modsel)
setwd("/Volumes/HD2/manolo/OneDrive/LaGEVol/Artigos_DoutoradoBelManolo/ArtigoDelimitacao/ABC/ABC_CO/IndMarkers/ABC")
sust<-read.table("SuSt.txt")
models<-scan("models.txt")
emp<-read.table("Emp.txt")
numsim=1
numloc=20
emp <- data.frame(s1=tapply(emp[,1], factor(rep(1:numsim, each=numloc)), mean,na.rm=T),
s2=tapply(emp[,2], factor(rep(1:numsim, each=numloc)), mean,na.rm=T),
s3=tapply(emp[,3], factor(rep(1:numsim, each=numloc)), mean,na.rm=T),
s4=tapply(emp[,4], factor(rep(1:numsim, each=numloc)), mean,na.rm=T),
s5=tapply(emp[,5], factor(rep(1:numsim, each=numloc)), mean,na.rm=T),
s6=tapply(emp[,6], factor(rep(1:numsim, each=numloc)), mean,na.rm=T),
s7=tapply(emp[,7], factor(rep(1:numsim, each=numloc)), mean,na.rm=T),
s8=tapply(emp[,8], factor(rep(1:numsim, each=numloc)), mean,na.rm=T),
s9=tapply(emp[,9], factor(rep(1:numsim, each=numloc)), mean,na.rm=T),
s10=tapply(emp[,10], factor(rep(1:numsim, each=numloc)), mean,na.rm=T),
s11=tapply(emp[,11], factor(rep(1:numsim, each=numloc)), mean,na.rm=T),
s12=tapply(emp[,12], factor(rep(1:numsim, each=numloc)), mean,na.rm=T),
s13=tapply(emp[,13], factor(rep(1:numsim, each=numloc)), mean,na.rm=T),
s14=tapply(emp[,14], factor(rep(1:numsim, each=numloc)), mean,na.rm=T),
s15=tapply(emp[,15], factor(rep(1:numsim, each=numloc)), mean,na.rm=T))
pcasust <- prcomp(sust, scale = TRUE)
pcaemp<-predict(pcasust, emp, scale=TRUE)
pcaemp
summary(pcasust)
pcasust
pcaemp
emp
pcaemp<-predict(pcasust, emp, scale=TRUE)
pcaemp
pcasust<-pcasust$x[,1:4]
pcaemp<-pcaemp[1:4]
pcaemp
pcasust
NN05<-postpr(emp, models, sust, tol = 0.005, method = "neuralnet")
summary(NN05)
